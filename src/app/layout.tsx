"use client";
import "./globals.css";
import React, { useEffect } from "react";
import MyThemeProvider from "@/components/ThemeProvider";
import SearchAppBar from "@/components/Navbar";
import NavbarCategories from "@/components/Navbar/NavbarCategories";
import Footer from "@/components/Footer";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { GoogleOAuthProvider } from "@react-oauth/google";
import ProgressProvider from "@/components/ProgressProvider";
import { SessionProvider } from "next-auth/react";
import { ToastContainer, toast } from "react-toastify";

import "react-toastify/dist/ReactToastify.css";

export const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      refetchOnWindowFocus: false,
      refetchOnReconnect: false,
    },
    mutations: {},
  },
});

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <SessionProvider>
      <QueryClientProvider client={queryClient}>
        <GoogleOAuthProvider
          clientId={process.env.NEXT_PUBLIC_GOOGLE_CLIENT as string}
        >
          <MyThemeProvider>
            <html lang="en">
              <body>
                <ProgressProvider>
                  <ToastContainer />
                  <SearchAppBar />
                  <NavbarCategories />
                  <div style={{ minHeight: "100vh" }}>{children}</div>
                  <Footer />
                </ProgressProvider>
              </body>
            </html>
          </MyThemeProvider>
        </GoogleOAuthProvider>
      </QueryClientProvider>
    </SessionProvider>
  );
}
